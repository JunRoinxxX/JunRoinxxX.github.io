<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Linux-[sh]脚本语法 | Raw-Stack|搬砖小栈</title><script src="https://cdn.bootcss.com/valine/1.4.4/Valine.min.js"></script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="/css/atom-one-dark-reasonable.min.css"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Raw-Stack|搬砖小栈" type="application/atom+xml">
</head><body><header><nav><a href="/">Home</a><a href="/about">About</a><a href="/archives">Archives</a></nav></header><main><article><div id="post-bg"><div id="post-title"><div id="post-info"><span>date:<time datetime="2020-07-15T14:18:50.000Z" id="date"> 2020-07-15</time></span></div><h1>Linux-[sh]脚本语法</h1><hr></div><div id="post-content"><hr>
<h1 id="一、文件开头"><a href="#一、文件开头" class="headerlink" title="一、文件开头"></a>一、文件开头</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br></code></pre></td></tr></table></figure>
<p>符号#!用来告诉系统它后面的参数是用来执行该文件的程序</p>
<p>编写完的sh脚本使其可执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo chmod +x filename<br></code></pre></td></tr></table></figure>

<h1 id="二、变量"><a href="#二、变量" class="headerlink" title="二、变量"></a>二、变量</h1><p><strong><em>在shell编程中，所有的变量都由字符串组成，并且不需要对变量进行声明</em></strong></p>
<h2 id="对变量赋值："><a href="#对变量赋值：" class="headerlink" title="对变量赋值："></a>对变量赋值：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">param = <span class="hljs-string">"hello world"</span><br></code></pre></td></tr></table></figure>

<h2 id="打印变量："><a href="#打印变量：" class="headerlink" title="打印变量："></a>打印变量：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$param</span><br></code></pre></td></tr></table></figure>

<h2 id="混用："><a href="#混用：" class="headerlink" title="混用："></a>混用：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">num=2<br><span class="hljs-built_in">echo</span> <span class="hljs-string">"this is the <span class="hljs-variable">$&#123;num&#125;</span>nd"</span><br><span class="hljs-comment"># 这将打印： this is the 2nd</span><br></code></pre></td></tr></table></figure>


<h1 id="三、shell命令和流程控制"><a href="#三、shell命令和流程控制" class="headerlink" title="三、shell命令和流程控制"></a>三、shell命令和流程控制</h1><p><strong>在shell脚本中可以使用三类命令：</strong></p>
<h2 id="1-Unix-命令"><a href="#1-Unix-命令" class="headerlink" title="1) Unix 命令:"></a>1) Unix 命令:</h2><h3 id="base-cp拷贝-mv移动或重命名-rm删除-cat输出预览-find搜索"><a href="#base-cp拷贝-mv移动或重命名-rm删除-cat输出预览-find搜索" class="headerlink" title="base: cp拷贝/mv移动或重命名/rm删除/cat输出预览/find搜索"></a><u>base</u>: cp拷贝/mv移动或重命名/rm删除/cat输出预览/find搜索</h3><h3 id="直接打印字符串内容："><a href="#直接打印字符串内容：" class="headerlink" title="直接打印字符串内容："></a>直接打印字符串内容：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">"k210 nb"</span><br></code></pre></td></tr></table></figure>

<h3 id="计算文件行数-文件中的单词数-文件中的字符数："><a href="#计算文件行数-文件中的单词数-文件中的字符数：" class="headerlink" title="计算文件行数/文件中的单词数/文件中的字符数："></a>计算文件行数/文件中的单词数/文件中的字符数：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wc –l file<br>wc -w file<br>wc -c file<br></code></pre></td></tr></table></figure>

<h3 id="在文件内搜索字符串："><a href="#在文件内搜索字符串：" class="headerlink" title="在文件内搜索字符串："></a>在文件内搜索字符串：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep <span class="hljs-string">'namespace'</span> file.cpp<br></code></pre></td></tr></table></figure>

<h3 id="指定欲显示的文件内容范围，并将它们输出到标准输出设备："><a href="#指定欲显示的文件内容范围，并将它们输出到标准输出设备：" class="headerlink" title="指定欲显示的文件内容范围，并将它们输出到标准输出设备："></a>指定欲显示的文件内容范围，并将它们输出到标准输出设备：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">cut -b colnum file<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 输出每行第5个到第9个字符</span><br>cut -b 5-9 file.cpp<br></code></pre></td></tr></table></figure>

<h3 id="得到文件类型："><a href="#得到文件类型：" class="headerlink" title="得到文件类型："></a>得到文件类型：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">file somefile<br></code></pre></td></tr></table></figure>

<h3 id="提示用户输入，并将输入赋值给变量："><a href="#提示用户输入，并将输入赋值给变量：" class="headerlink" title="提示用户输入，并将输入赋值给变量："></a>提示用户输入，并将输入赋值给变量：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">read</span> param<br></code></pre></td></tr></table></figure>

<h3 id="打印文本文件开头几行-末尾几行："><a href="#打印文本文件开头几行-末尾几行：" class="headerlink" title="打印文本文件开头几行/末尾几行："></a>打印文本文件开头几行/末尾几行：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">head file<br><br>tail file<br></code></pre></td></tr></table></figure>

<h2 id="2-概念-管道，重定向和backtick"><a href="#2-概念-管道，重定向和backtick" class="headerlink" title="2) 概念: 管道，重定向和backtick"></a>2) 概念: 管道，重定向和backtick</h2><h3 id="管道-—–将一个命令的输出作为另外一个命令的输入"><a href="#管道-—–将一个命令的输出作为另外一个命令的输入" class="headerlink" title="管道(|)—–将一个命令的输出作为另外一个命令的输入"></a>管道(|)—–将一个命令的输出作为另外一个命令的输入</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 在file.txt中搜索包含有"hello"的行并计算其行数</span><br>grep <span class="hljs-string">"hello"</span> file.txt | wc -l<br></code></pre></td></tr></table></figure>

<h3 id="重定向—–将本应输出在终端上的内容写入到指定文件中"><a href="#重定向—–将本应输出在终端上的内容写入到指定文件中" class="headerlink" title="重定向—–将本应输出在终端上的内容写入到指定文件中"></a>重定向—–将本应输出在终端上的内容写入到指定文件中</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">&gt; <span class="hljs-comment"># 写入文件并覆盖旧文件（没有则创建）</span><br>ls &gt; test.txt<br><br>&gt;&gt; <span class="hljs-comment">#将输出内容追加到目标文件（没有则创建）</span><br></code></pre></td></tr></table></figure>

<h3 id="backtick-—–使用反短斜线可以将一个命令的输出作为另外一个命令的一个命令行参数"><a href="#backtick-—–使用反短斜线可以将一个命令的输出作为另外一个命令的一个命令行参数" class="headerlink" title="backtick(``)—–使用反短斜线可以将一个命令的输出作为另外一个命令的一个命令行参数"></a>backtick(``)—–使用反短斜线可以将一个命令的输出作为另外一个命令的一个命令行参数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 将所查找到的文件打包</span><br>tar -zcvf lastmod.tar.gz `find . -mtime -1 -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">print</span>`<br></code></pre></td></tr></table></figure>

<h2 id="3-流程控制"><a href="#3-流程控制" class="headerlink" title="3) 流程控制"></a>3) 流程控制</h2><h3 id="1-if表达式"><a href="#1-if表达式" class="headerlink" title="1.if表达式"></a>1.if表达式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 基本结构</span><br><span class="hljs-keyword">if</span> ...; <span class="hljs-keyword">then</span><br>...<br><span class="hljs-keyword">elif</span> ...; <span class="hljs-keyword">then</span><br>...<br><span class="hljs-keyword">else</span><br>...<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure>
<p><strong><u>通常用”[ ]”来表示条件测试</u></strong>。<em>（注意这里的空格很重要，要确保方括号的空格）</em><br><strong>格式：</strong></p>
<blockquote>
<p>[ -f “somefile” ] : 判断是否是一个文件<br>[ -x “/bin/ls” ] : 判断/bin/ls是否存在并有可执行权限<br>[ -n “$var” ] : 判断$var变量是否有值<br>[ “$a” = “$b” ] : 判断$a和$b是否相等</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$SHELL</span>"</span> = <span class="hljs-string">"/bin/bash"</span> ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"your login shell is the bash (bourne again shell)"</span><br><span class="hljs-keyword">else</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"your login shell is not bash but <span class="hljs-variable">$SHELL</span>"</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure>
<p>熟悉C语言的朋友可能会很喜欢下面的表达式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[ -f <span class="hljs-string">"/etc/shadow"</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"This computer uses shadow passwors"</span><br><span class="hljs-comment"># 这里 &amp;&amp; 就是一个快捷操作符，如果左边的表达式为真则执行右边的语句</span><br></code></pre></td></tr></table></figure>
<p>同样或操作(||)在shell编程中也是可用的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br>mailfolder=/var/spool/mail/james<br>[ -r <span class="hljs-string">"<span class="hljs-variable">$mailfolder</span>"</span> ]<span class="hljs-string">' '</span>&#123; <span class="hljs-built_in">echo</span> <span class="hljs-string">"Can not read <span class="hljs-variable">$mailfolder</span>"</span> ; <span class="hljs-built_in">exit</span> 1; &#125;<br><span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$mailfolder</span> has mail from:"</span><br>grep <span class="hljs-string">"^From "</span> <span class="hljs-variable">$mailfolder</span><br></code></pre></td></tr></table></figure>
<p>​        该脚本首先判断mailfolder是否可读。如果可读则打印该文件中的”From” 一行。如果不可读则或操作生效，打印错误信息后脚本退出。这里有个问题，那就是我们必须有两个命令：<br>◆打印错误信息<br>◆退出程序<br>我们使用花括号以匿名函数的形式将两个命令放到一起作为一个命令使用。一般函数将在下文提及。<br>不用[与]和[或]操作符，我们也可以用if表达式作任何事情，但是使用与或操作符会更便利很多。</p>
<h3 id="2-case表达式"><a href="#2-case表达式" class="headerlink" title="2.case表达式"></a>2.case表达式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 基本结构</span><br><span class="hljs-keyword">case</span> ... <span class="hljs-keyword">in</span><br>...) <span class="hljs-keyword">do</span> something here ;;<br><span class="hljs-keyword">esac</span><br></code></pre></td></tr></table></figure>
<p><strong><u>例子：</u></strong><br>file命令可以辨别出一个给定文件的文件类型，比如：<br>file lf.gz<br>这将返回：<br>lf.gz: gzip compressed data, deflated, original filename,<br>last modified: Mon Aug 27 23:09:18 2001, os: Unix<br>我们利用这一点写了一个叫做smartzip的脚本，该脚本可以自动解压bzip2, gzip 和zip 类型的压缩文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br>ftype=`file <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>`<br><span class="hljs-keyword">case</span> <span class="hljs-string">"<span class="hljs-variable">$ftype</span>"</span> <span class="hljs-keyword">in</span><br><span class="hljs-string">"<span class="hljs-variable">$1</span>: Zip archive"</span>*)<br>unzip <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ;;<br><span class="hljs-string">"<span class="hljs-variable">$1</span>: gzip compressed"</span>*)<br>gunzip <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ;;<br><span class="hljs-string">"<span class="hljs-variable">$1</span>: bzip2 compressed"</span>*)<br>bunzip2 <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ;;<br>*) <span class="hljs-built_in">echo</span> <span class="hljs-string">"File <span class="hljs-variable">$1</span> can not be uncompressed with smartzip"</span>;;<br><span class="hljs-keyword">esac</span><br></code></pre></td></tr></table></figure>
<p>特殊变量$1包含了传递给该程序的第一个参数值，<br>也就是说，当我们运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">smartzip articles.zip<br></code></pre></td></tr></table></figure>
<p>$1 就是字符串 articles.zip</p>
<h3 id="3-selsect表达式"><a href="#3-selsect表达式" class="headerlink" title="3.selsect表达式"></a>3.selsect表达式</h3><p><em>一种bash的扩展应用，尤其擅长于交互式使用</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 基本结构</span><br>select var <span class="hljs-keyword">in</span> ... ; <span class="hljs-keyword">do</span><br><span class="hljs-built_in">break</span><br><span class="hljs-keyword">done</span><br>... now <span class="hljs-variable">$var</span> can be used ...<br></code></pre></td></tr></table></figure>
<p>例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"What is your favourite OS?"</span><br>select var <span class="hljs-keyword">in</span> <span class="hljs-string">"Linux"</span> <span class="hljs-string">"Gnu Hurd"</span> <span class="hljs-string">"Free BSD"</span> <span class="hljs-string">"Other"</span>; <span class="hljs-keyword">do</span><br><span class="hljs-built_in">break</span><br><span class="hljs-keyword">done</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"You have selected <span class="hljs-variable">$var</span>"</span><br></code></pre></td></tr></table></figure>

<p>下面是该脚本运行的结果：</p>
<blockquote>
<p>What is your favourite OS?</p>
<p>1) Linux<br>2) Gnu Hurd<br>3) Free BSD<br>4) Other<br>#? 1<br>You have selected Linux</p>
</blockquote>
<h3 id="4-loop"><a href="#4-loop" class="headerlink" title="4.loop"></a>4.loop</h3><p><u><strong>while-loop 将运行直到表达式测试为真</strong></u><br>关键字”break” 用来跳出循环。而关键字”continue”用来不执行余下的部分而直接跳到下一个循环</p>
<p><strong><u>for-loop表达式查看一个字符串列表 (字符串用空格分隔) 然后将其赋给一个变量：</u></strong></p>
<p>例子（分别打印ABC到屏幕上）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> A B C ; <span class="hljs-keyword">do</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"var is <span class="hljs-variable">$var</span>"</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>
<p>下面是一个更为有用的脚本showrpm，其功能是打印一些RPM包的统计信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># list a content summary of a number of RPM packages</span><br><span class="hljs-comment"># USAGE: showrpm rpmfile1 rpmfile2 …</span><br><span class="hljs-comment"># EXAMPLE: showrpm /cdrom/RedHat/RPMS/*.rpm</span><br><span class="hljs-keyword">for</span> rpmpackage <span class="hljs-keyword">in</span> $*; <span class="hljs-keyword">do</span><br><span class="hljs-keyword">if</span> [ -r <span class="hljs-string">"<span class="hljs-variable">$rpmpackage</span>"</span> ];<span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"=============== <span class="hljs-variable">$rpmpackage</span> =============="</span><br>rpm -qi -p <span class="hljs-variable">$rpmpackage</span><br><span class="hljs-keyword">else</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"ERROR: cannot read file <span class="hljs-variable">$rpmpackage</span>"</span><br><span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>
<p>这里出现了第二个特殊的变量($*)，该变量包含了所有输入的命令行参数值</p>
<h3 id="5-引号"><a href="#5-引号" class="headerlink" title="5.引号"></a>5.引号</h3><p><strong>在向程序传递任何参数之前，程序会扩展通配符和变量。这里所谓扩展的意思是程序会把通配符（比如*）替换成合适的文件名，它变量替换成变量值。为了防止程序作这种替换，您可以使用引号：让我们来看一个例子，假设在当前目录下有一些文件，两个jpg文件， mail.jpg 和tux.jpg</strong></p>
<p>引号 (单引号和双引号) 将防止这种<u>通配符</u>扩展：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"*.jpg"</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">'*.jpg'</span><br></code></pre></td></tr></table></figure>
<p>这将打印”*.jpg” 两次</p>
<p>And单引号更严格一些。它可以防止任何变量扩展。双引号可以防止通配符扩展但允许变量扩展：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$SHELL</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$SHELL</span>"</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">'$SHELL'</span><br></code></pre></td></tr></table></figure>
<p>运行结果为：</p>
<blockquote>
<p>/bin/bash<br>/bin/bash<br>$SHELL</p>
</blockquote>
<p>最后，还有一种防止这种扩展的方法，那就是使用转义字符——反斜杆：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> *.jpg<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$SHELL</span><br></code></pre></td></tr></table></figure>
<p>这将输出：</p>
<blockquote>
<p>*.jpg<br>$SHELL</p>
</blockquote>
<h3 id="6-Here-documents"><a href="#6-Here-documents" class="headerlink" title="6.Here documents"></a>6.Here documents</h3><blockquote>
<p>略</p>
</blockquote>
<h1 id="实例列举"><a href="#实例列举" class="headerlink" title="实例列举"></a>实例列举</h1><h2 id="1-二进制到十进制的转换"><a href="#1-二进制到十进制的转换" class="headerlink" title="1) 二进制到十进制的转换"></a>1) 二进制到十进制的转换</h2><p>该脚本 b2d 将二进制数 (比如 1101) 转换为相应的十进制数。这也是一个用expr命令进行数学运算的例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># vim: set sw=4 ts=4 et:</span><br><span class="hljs-built_in">help</span>()<br>&#123;<br>cat &lt;<br>b2h — convert binary to decimal<br>USAGE: b2h [-h] binarynum<br>OPTIONS: -h <span class="hljs-built_in">help</span> text<br>EXAMPLE: b2h 111010<br>will <span class="hljs-built_in">return</span> 58<br>HELP<br><span class="hljs-built_in">exit</span> 0<br>&#125;<br>error()<br>&#123;<br><span class="hljs-comment"># print an error and exit</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span><br><span class="hljs-built_in">exit</span> 1<br>&#125;<br>lastchar()<br>&#123;<br><span class="hljs-comment"># return the last character of a string in $rval</span><br><span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$1</span>″ ]; then</span><br><span class="hljs-string"># empty string</span><br><span class="hljs-string">rval="</span><span class="hljs-string">"</span><br><span class="hljs-string">return</span><br><span class="hljs-string">fi</span><br><span class="hljs-string"># wc puts some space behind the output this is why we need sed:</span><br><span class="hljs-string">numofchar=`echo -n "</span><span class="hljs-variable">$1</span><span class="hljs-string">" | wc -c | sed 's/ //g' `</span><br><span class="hljs-string"># now cut out the last char</span><br><span class="hljs-string">rval=`echo -n "</span><span class="hljs-variable">$1</span><span class="hljs-string">" | cut -b <span class="hljs-variable">$numofchar</span>`</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">chop()</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string"># remove the last character in string and return it in <span class="hljs-variable">$rval</span></span><br><span class="hljs-string">if [ -z "</span><span class="hljs-variable">$1</span>″ ]; <span class="hljs-keyword">then</span><br><span class="hljs-comment"># empty string</span><br>rval=<span class="hljs-string">""</span><br><span class="hljs-built_in">return</span><br><span class="hljs-keyword">fi</span><br><span class="hljs-comment"># wc puts some space behind the output this is why we need sed:</span><br>numofchar=`<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> | wc -c | sed <span class="hljs-string">'s/ //g'</span> `<br><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$numofchar</span>"</span> = <span class="hljs-string">"1"</span> ]; <span class="hljs-keyword">then</span><br><span class="hljs-comment"># only one char in string</span><br>rval=<span class="hljs-string">""</span><br><span class="hljs-built_in">return</span><br><span class="hljs-keyword">fi</span><br>numofcharminus1=`expr <span class="hljs-variable">$numofchar</span> <span class="hljs-string">"-"</span> 1`<br><span class="hljs-comment"># now cut all but the last char:</span><br>rval=`<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> | cut -b 0-<span class="hljs-variable">$&#123;numofcharminus1&#125;</span>`<br>&#125;<br><span class="hljs-keyword">while</span> [ -n <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]; <span class="hljs-keyword">do</span><br><span class="hljs-keyword">case</span> <span class="hljs-variable">$1</span> <span class="hljs-keyword">in</span><br>-h) <span class="hljs-built_in">help</span>;<span class="hljs-built_in">shift</span> 1;; <span class="hljs-comment"># function help is called</span><br>–) <span class="hljs-built_in">shift</span>;<span class="hljs-built_in">break</span>;; <span class="hljs-comment"># end of options</span><br>-*) error <span class="hljs-string">"error: no such option <span class="hljs-variable">$1</span>. -h for help"</span>;;<br>*) <span class="hljs-built_in">break</span>;;<br><span class="hljs-keyword">esac</span><br><span class="hljs-keyword">done</span><br><span class="hljs-comment"># The main program</span><br>sum=0<br>weight=1<br><span class="hljs-comment"># one arg must be given:</span><br>[ -z <span class="hljs-string">"<span class="hljs-variable">$1</span>″ ] &amp;&amp; help</span><br><span class="hljs-string">binnum="</span><span class="hljs-variable">$1</span>″<br>binnumorig=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span><br><span class="hljs-keyword">while</span> [ -n <span class="hljs-string">"<span class="hljs-variable">$binnum</span>"</span> ]; <span class="hljs-keyword">do</span><br>lastchar <span class="hljs-string">"<span class="hljs-variable">$binnum</span>"</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$rval</span>"</span> = <span class="hljs-string">"1"</span> ]; <span class="hljs-keyword">then</span><br>sum=`expr <span class="hljs-string">"<span class="hljs-variable">$weight</span>"</span> <span class="hljs-string">"+"</span> <span class="hljs-string">"<span class="hljs-variable">$sum</span>"</span>`<br><span class="hljs-keyword">fi</span><br><span class="hljs-comment"># remove the last position in $binnum</span><br>chop <span class="hljs-string">"<span class="hljs-variable">$binnum</span>"</span><br>binnum=<span class="hljs-string">"<span class="hljs-variable">$rval</span>"</span><br>weight=`expr <span class="hljs-string">"<span class="hljs-variable">$weight</span>"</span> <span class="hljs-string">"*"</span> 2`<br><span class="hljs-keyword">done</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">"binary <span class="hljs-variable">$binnumorig</span> is decimal <span class="hljs-variable">$sum</span>"</span><br></code></pre></td></tr></table></figure>

<p>该脚本使用的算法是利用十进制和二进制数权值 (1,2,4,8,16,..)，比如二进制”10″可以这样转换成十进制：<br>0 * 1 + 1 * 2 = 2<br>为了得到单个的二进制数我们是用了lastchar 函数。该函数使用wc –c计算字符个数，然后使用cut命令取出末尾一个字符。Chop函数的功能则是移除最后一个字符。</p>
<h2 id="2-待添加实例"><a href="#2-待添加实例" class="headerlink" title="2) 待添加实例"></a>2) 待添加实例</h2><p>略</p>
<h2 id="3-调试"><a href="#3-调试" class="headerlink" title="3) 调试"></a>3) 调试</h2><p>最简单的调试命令当然是使用echo命令。您可以使用echo在任何怀疑出错的地方打印任何变量值。这也是绝大多数的shell程序员要花费80%的时间来调试程序的原因。Shell程序的好处在于不需要重新编译，插入一个echo命令也不需要多少时间。<br><u><strong>shell也有一个真实的调试模式。如果在脚本”strangescript” 中有错误，您可以这样来进行调试：</u></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sh -x strangescript<br></code></pre></td></tr></table></figure>
<p>这将执行该脚本并显示所有变量的值。</p>
<p>shell还有一个不需要执行脚本只是检查语法的模式。可以这样使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sh -n your_script<br></code></pre></td></tr></table></figure>

<p>这将返回所有语法错误。</p>
<div id="paginator"></div></div><div id="post-footer"><hr><a href="/posts/4f23aaa0/">← Prev 关于Riscv板载Linux公钥问题老报错的resolve</a><span style="color: #fe2"> | </span><a href="/posts/8bb07b66/">Debian取消默认Dash Next →</a><hr></div><div id="bottom-btn"><a id="to-index" href="#post-index" title="index">≡</a><a id="to-top" href="#post-title" title="to top">∧</a></div><details id="reward"><summary><font color=#CC2D08>交</font><font color=#995A10>个</font><font color=#668718>盆</font><font color=#33B420>友</font></summary><div id="alipay"><span>照片 | Picture</span><br><img src="http://qccwitqct.bkt.clouddn.com/image/Alipay.png"></div><div id="wechat"><span>微信 | WeChat</span><br><img src="http://qccwitqct.bkt.clouddn.com/image/WeChat.png"></div></details><div id="Valine"></div><script>new Valine({
 el: '#Valine'
 , appId: 'plL7RniFJ5sGo98XaVBF8Twf-gzGzoHsz'
 , appKey: 'JSR12m0LR20zvoTpNhk0QdNU'
 , placeholder: '此条评论委托企鹅物流发送'
})</script></div></article><aside><div id="about"><a href="/" id="logo"><img src="http://qccwitqct.bkt.clouddn.com/image/1.png" alt="Logo"></a><h1 id="Dr"><a href="http://ak.mooncell.wiki/" target="_blank" rel="noopener"> Dr.RoinxxX</a></h1><section id="total"><a id="total-archives" href="/archives"><span class="total-title">Archives Total:</span><span class="total-number">20</span></a><div id="total-tags"><span class="total-title">Tags:</span><span class="total-number">8</span></div><div id="total-categories"><span class="total-title">Categories:</span><span class="total-number">2</span></div></section></div><div id="aside-block"><h1>INDEX</h1><div id="post-index"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一、文件开头"><span class="toc-number">1.</span> <span class="toc-text">一、文件开头</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二、变量"><span class="toc-number">2.</span> <span class="toc-text">二、变量</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#对变量赋值："><span class="toc-number">2.1.</span> <span class="toc-text">对变量赋值：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打印变量："><span class="toc-number">2.2.</span> <span class="toc-text">打印变量：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#混用："><span class="toc-number">2.3.</span> <span class="toc-text">混用：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三、shell命令和流程控制"><span class="toc-number">3.</span> <span class="toc-text">三、shell命令和流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Unix-命令"><span class="toc-number">3.1.</span> <span class="toc-text">1) Unix 命令:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base-cp拷贝-mv移动或重命名-rm删除-cat输出预览-find搜索"><span class="toc-number">3.1.1.</span> <span class="toc-text">base: cp拷贝&#x2F;mv移动或重命名&#x2F;rm删除&#x2F;cat输出预览&#x2F;find搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#直接打印字符串内容："><span class="toc-number">3.1.2.</span> <span class="toc-text">直接打印字符串内容：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#计算文件行数-文件中的单词数-文件中的字符数："><span class="toc-number">3.1.3.</span> <span class="toc-text">计算文件行数&#x2F;文件中的单词数&#x2F;文件中的字符数：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在文件内搜索字符串："><span class="toc-number">3.1.4.</span> <span class="toc-text">在文件内搜索字符串：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指定欲显示的文件内容范围，并将它们输出到标准输出设备："><span class="toc-number">3.1.5.</span> <span class="toc-text">指定欲显示的文件内容范围，并将它们输出到标准输出设备：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#得到文件类型："><span class="toc-number">3.1.6.</span> <span class="toc-text">得到文件类型：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#提示用户输入，并将输入赋值给变量："><span class="toc-number">3.1.7.</span> <span class="toc-text">提示用户输入，并将输入赋值给变量：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#打印文本文件开头几行-末尾几行："><span class="toc-number">3.1.8.</span> <span class="toc-text">打印文本文件开头几行&#x2F;末尾几行：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-概念-管道，重定向和backtick"><span class="toc-number">3.2.</span> <span class="toc-text">2) 概念: 管道，重定向和backtick</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#管道-—–将一个命令的输出作为另外一个命令的输入"><span class="toc-number">3.2.1.</span> <span class="toc-text">管道(|)—–将一个命令的输出作为另外一个命令的输入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#重定向—–将本应输出在终端上的内容写入到指定文件中"><span class="toc-number">3.2.2.</span> <span class="toc-text">重定向—–将本应输出在终端上的内容写入到指定文件中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#backtick-—–使用反短斜线可以将一个命令的输出作为另外一个命令的一个命令行参数"><span class="toc-number">3.2.3.</span> <span class="toc-text">backtick(&#96;&#96;)—–使用反短斜线可以将一个命令的输出作为另外一个命令的一个命令行参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-流程控制"><span class="toc-number">3.3.</span> <span class="toc-text">3) 流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-if表达式"><span class="toc-number">3.3.1.</span> <span class="toc-text">1.if表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-case表达式"><span class="toc-number">3.3.2.</span> <span class="toc-text">2.case表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-selsect表达式"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.selsect表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-loop"><span class="toc-number">3.3.4.</span> <span class="toc-text">4.loop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-引号"><span class="toc-number">3.3.5.</span> <span class="toc-text">5.引号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-Here-documents"><span class="toc-number">3.3.6.</span> <span class="toc-text">6.Here documents</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#实例列举"><span class="toc-number">4.</span> <span class="toc-text">实例列举</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-二进制到十进制的转换"><span class="toc-number">4.1.</span> <span class="toc-text">1) 二进制到十进制的转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-待添加实例"><span class="toc-number">4.2.</span> <span class="toc-text">2) 待添加实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-调试"><span class="toc-number">4.3.</span> <span class="toc-text">3) 调试</span></a></li></ol></li></ol></div></div><footer><nobr><span class="text-title">©</span><span class="text-content">None</span></nobr><wbr><nobr><span class="text-title">ICP</span><span class="text-content">就是不给我过审</span></nobr><wbr><wbr><nobr>published with&nbsp;<a href="http://hexo.io" target="_blank" rel="noopener">Hexo&nbsp;</a></nobr><wbr><nobr>Theme&nbsp;<a href="https://github.com/Yue-plus/hexo-theme-arknights" target="_blank" rel="noopener">Arknight&nbsp;</a></nobr><wbr><nobr>by&nbsp;<a href="https://github.com/Yue-plus" target="_blank" rel="noopener">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/arknights.js"></script></body></html>